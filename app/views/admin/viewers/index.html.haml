- @title = "Viewers"

- content_for :sidebar, render("setup/sidebar")
- content_for :header do
  .float-right
    = link_to plus_or("New Viewer"), new_admin_viewer_path, class: "btn btn-primary btn-shadow"
    .per-page= render "layouts/per_page", per_page: 40, object_count: @viewers.total_count
  = @title

.dashboard-container.dashboard-table
  %table.table.table-striped.table-borderless.table-hover.table-sticky
    %col
    %col
    %col
    %col
    %col{ width: "1px" }
    %thead
      %tr
        = th_sort_field @order, "viewers.username", "Username"
        %th Password
        = th_sort_field @order, "viewers.current_sign_in_at", "Recent Activity"
        = th_sort_field @order, "viewers.sign_in_count", "Sign in Count"
        %th.text-center Actions

    - @viewers.each do |viewer|
      %tr
        %td= link_to viewer.username, admin_viewer_path(viewer)
        %td
          %span.masked{ data: { object: "click-to-view", content: viewer.password_plain } }
            = "*" * viewer.password_plain.to_s.size
        %td
          - if viewer.current_sign_in_at
            = time_ago_in_words viewer.current_sign_in_at
            ago
        %td= number_with_delimiter viewer.sign_in_count
        %td.text-center.nowrap
          = render "layouts/edit_delete_dropdown", edit_url: edit_admin_viewer_path(viewer), delete_url: admin_viewer_path(viewer), delete_confirmation: "Delete #{viewer.username}?"

.center-horizontally
  = paginate @viewers, theme: "bootstrap"
